# Домашнее задание № 6

В рамках домашней работы нужно будет создать пайплайн обработки данных, который будет включать в себя работу с изученными библиотеками -
Psycopg2, SQLAlchemy, Pymongo.

Шаблон домашней раюоты содержится в файлe hw3.py. Импорты необходимых библиотек выполнены, требуется заполнить недостающие места в коде.

1. Psycopg2

Необходимо с помощью Psycorg выполнить создание таблицы movies_top c помощью конструкции
<pre>
    SELECT *  INTO movies_top FROM (ЗАПРОС);
</pre>

Где ЗАПРОС имеет следующий вид:
- три поля: movieId (id фильма), ratings_num(число рейтингов), ratings_avg (средний рейтинг фильма)
- В выборку должны попасть только фильмы, у которых средний рейтинг выше 3.

2. SQLAlchemy

Нужно подключиться с помощью интерфейсов SQLAlchemy к новой таблице  movies_top.

С помощью механизмов ORM написать запрос , который

2.1) выберите контент у которого больше 15 оценок (используйте filter)

2.2) средний рейтинг больше 3.5 (filter ещё раз)

2.3) отсортировать по среднему рейтингу (используйте order_by())

id этих фильмов сохраняем в массив top_rated_content_ids

3. Pymongo

Нужно подключиться к Pymongo и и выгрузить список тегов для списка популярного контента, полученный на предыдущем шаге.

В выборку должны попать теги фильмов из массива top_rated_content_ids и модификатор $in.

4. Pandas

Из списка выгруженных тегов составим Pandas DataFrame.

4.1 Сгруппируйте по названию тега с помощью group_by

4.2 Для каждого тега вычислите, в каком количестве фильмов он встречается

4.3 Оставьте top-5 самых популярных тегов

На этом всё! Домашка выполнена.